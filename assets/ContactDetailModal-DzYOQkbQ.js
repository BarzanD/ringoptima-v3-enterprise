import{m as j,j as e,A as P}from"./motion-59ipwzXq.js";import{r as l}from"./charts-KwIshsWb.js";import{c as x,u as E,d as A,e as K,g as v,t as c,h as L,i as d,X as D,j as I,k as T,l as $,m as z,M as V,n as R,P as f,o as H,p as N}from"./index-MfJbMkFF.js";import"./vendor-b0vXyz-r.js";const U=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],q=x("briefcase",U);const B=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],F=x("clock",B);const O=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],W=x("copy",O);const X=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],G=x("message-square",X);const J=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Q=x("save",J),Y=[{value:"new",label:"Ny",color:"bg-slate-500"},{value:"contacted",label:"Kontaktad",color:"bg-sky-500"},{value:"interested",label:"Intresserad",color:"bg-amber-500"},{value:"not_interested",label:"Ej intresserad",color:"bg-red-500"},{value:"converted",label:"Konverterad",color:"bg-brand-500"}],Z=[{value:"high",label:"Hög"},{value:"medium",label:"Medium"},{value:"low",label:"Låg"}],le=l.memo(function({contact:s,onClose:n,onDelete:p}){const b=E(a=>a.updateContact),i=A(),y=K(!0),[r,h]=l.useState(!1),[u,g]=l.useState(!1),[t,o]=l.useState({status:s.status,priority:s.priority,notes:s.notes,contact:s.contact,role:s.role});l.useEffect(()=>{const a=m=>{m.key==="Escape"&&n()};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[n]);const k=l.useCallback(async()=>{if(s.id){g(!0);try{await v.updateContact(s.id,{status:t.status,priority:t.priority,notes:t.notes,contact:t.contact,role:t.role}),b(s.id,t),h(!1),c.success("Kontakt uppdaterad")}catch(a){c.error("Kunde inte spara ändringar"),console.error(a)}finally{g(!1)}}},[s.id,t,b]),w=l.useCallback(async()=>{if(!(!s.id||!p)&&confirm("Är du säker på att du vill radera denna kontakt?"))try{await v.deleteContact(s.id),p(s.id),n(),c.success("Kontakt raderad")}catch(a){c.error("Kunde inte radera kontakt"),console.error(a)}},[s.id,p,n]),C=l.useCallback(async a=>{await L(a)&&c.success("Telefonnummer kopierat")},[]);l.useCallback(a=>{window.location.href=`tel:${a.replace(/\D/g,"")}`},[]);const M=s.name.split(" ").map(a=>a[0]).slice(0,2).join("").toUpperCase(),S=i?"div":j.div,_=i?{}:{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2}};return e.jsxs(P,{children:[e.jsx(j.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:d("fixed inset-0 z-50",i?"mobile-modal-overlay":"bg-black/40 backdrop-blur-sm"),onClick:n,"aria-hidden":"true"}),e.jsxs(S,{..._,ref:y,className:d(i?"mobile-modal-sheet":"fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-50 w-full max-w-2xl max-h-[90vh] overflow-hidden rounded-2xl glass-card bg-white"),role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",onClick:a=>a.stopPropagation(),children:[i&&e.jsx("div",{className:"mobile-modal-handle",children:e.jsx("div",{className:"mobile-modal-handle-bar bg-[rgba(37,150,190,0.2)]"})}),e.jsxs("div",{className:d("flex items-center gap-4 p-6 border-b border-[rgba(37,150,190,0.2)]",i&&"p-4"),children:[e.jsx("div",{className:"w-16 h-16 flex-shrink-0 flex items-center justify-center rounded-2xl bg-gradient-to-br from-[#2596be] to-[#1e7a9c] text-white font-bold text-xl shadow-lg shadow-[rgba(37,150,190,0.3)]",children:M}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{id:"modal-title",className:"text-xl font-bold text-[#000000] truncate",children:s.name}),e.jsx("p",{className:"text-sm text-[rgba(60,60,67,0.6)]",children:s.org||"Inget orgnr"})]}),e.jsx("button",{onClick:n,className:"btn-icon","aria-label":"Stäng",children:e.jsx(D,{className:"w-5 h-5 text-[rgba(60,60,67,0.6)]"})})]}),e.jsxs("div",{className:d("overflow-y-auto p-6 space-y-6 bg-white",i&&"mobile-modal-body"),children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>h(!r),className:d("btn-secondary flex items-center gap-2",r&&"bg-[rgba(37,150,190,0.1)] border-[rgba(37,150,190,0.3)] text-[#2596be]"),children:[e.jsx(I,{className:"w-4 h-4"}),r?"Avbryt":"Redigera"]}),r&&e.jsxs("button",{onClick:k,disabled:u,className:"btn-primary flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4"}),u?"Sparar...":"Spara"]}),e.jsx("button",{onClick:w,className:"btn-ghost text-[#ef4444] hover:text-[#dc2626] hover:bg-[rgba(239,68,68,0.1)]",children:e.jsx(T,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[rgba(60,60,67,0.6)] mb-2",children:"Status"}),r?e.jsx("select",{value:t.status,onChange:a=>o({...t,status:a.target.value}),className:"select-field",children:Y.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:d("status-dot",`status-${s.status.replace("_","-")}`)}),e.jsx("span",{className:"text-[#000000]",children:$(s.status)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[rgba(60,60,67,0.6)] mb-2",children:"Prioritet"}),r?e.jsx("select",{value:t.priority,onChange:a=>o({...t,priority:a.target.value}),className:"select-field",children:Z.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))}):e.jsx("span",{className:"text-[#000000]",children:z(s.priority)})]})]}),e.jsxs("div",{className:"grid gap-4",children:[(s.address||s.city)&&e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-xl bg-[rgba(255,255,255,0.6)] backdrop-blur-[10px] border border-[rgba(37,150,190,0.2)]",children:[e.jsx(V,{className:"w-5 h-5 text-[#2596be] flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-[rgba(60,60,67,0.6)]",children:"Adress"}),e.jsxs("p",{className:"text-[#000000]",children:[s.address,s.address&&s.city&&", ",s.city]})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-xl bg-[rgba(255,255,255,0.6)] backdrop-blur-[10px] border border-[rgba(37,150,190,0.2)]",children:[e.jsx(R,{className:"w-5 h-5 text-[#2596be] flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-[rgba(60,60,67,0.6)]",children:"Kontaktperson"}),r?e.jsx("input",{type:"text",value:t.contact,onChange:a=>o({...t,contact:a.target.value}),className:"input-field mt-1",placeholder:"Namn på kontaktperson"}):e.jsx("p",{className:"text-[#000000]",children:s.contact||"—"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-xl bg-[rgba(255,255,255,0.6)] backdrop-blur-[10px] border border-[rgba(37,150,190,0.2)]",children:[e.jsx(q,{className:"w-5 h-5 text-[#2596be] flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-[rgba(60,60,67,0.6)]",children:"Roll"}),r?e.jsx("input",{type:"text",value:t.role,onChange:a=>o({...t,role:a.target.value}),className:"input-field mt-1",placeholder:"VD, Säljchef, etc."}):e.jsx("p",{className:"text-[#000000]",children:s.role||"—"})]})]}),s.phones&&e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-xl bg-[rgba(255,255,255,0.6)] backdrop-blur-[10px] border border-[rgba(37,150,190,0.2)]",children:[e.jsx(f,{className:"w-5 h-5 text-[#2596be] flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm text-[rgba(60,60,67,0.6)] mb-2",children:["Telefonnummer (",H(s.phones),")"]}),e.jsx("div",{className:"space-y-2",children:s.phones.split(`
`).filter(Boolean).map((a,m)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[#000000] font-mono text-sm",children:a}),e.jsx("button",{onClick:()=>C(a),className:"p-1 rounded hover:bg-[rgba(37,150,190,0.1)] text-[rgba(60,60,67,0.6)] hover:text-[#2596be]","aria-label":"Kopiera",children:e.jsx(W,{className:"w-3.5 h-3.5"})}),e.jsx("a",{href:`tel:${a.replace(/\D/g,"")}`,className:"p-1 rounded hover:bg-[rgba(37,150,190,0.1)] text-[#2596be]","aria-label":"Ring",children:e.jsx(f,{className:"w-3.5 h-3.5"})})]},m))})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-[rgba(60,60,67,0.6)] mb-2",children:[e.jsx(G,{className:"w-4 h-4"}),"Anteckningar"]}),r?e.jsx("textarea",{value:t.notes,onChange:a=>o({...t,notes:a.target.value}),className:"input-field min-h-[120px] resize-y",placeholder:"Lägg till anteckningar om samtalet..."}):e.jsx("div",{className:"p-4 rounded-xl bg-[rgba(255,255,255,0.6)] backdrop-blur-[10px] border border-[rgba(37,150,190,0.2)] min-h-[80px]",children:s.notes?e.jsx("p",{className:"text-[#000000] whitespace-pre-wrap",children:s.notes}):e.jsx("p",{className:"text-[rgba(60,60,67,0.4)] italic",children:"Inga anteckningar"})})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-[rgba(60,60,67,0.6)] pt-4 border-t border-[rgba(37,150,190,0.2)]",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(F,{className:"w-3.5 h-3.5"}),"Skapad: ",N(s.createdAt)]}),e.jsxs("span",{children:["Uppdaterad: ",N(s.updatedAt)]})]})]})]})]})});export{le as default};
