import{m as g,j as e,A as E}from"./motion-59ipwzXq.js";import{r}from"./charts-KwIshsWb.js";import{c as m,u as _,d as L,e as A,g as v,t as c,h as K,i as d,X as D,j as I,k as T,l as z,M as $,m as R,P as f,n as V,o as H,p as N,q}from"./index-CeFc9Hgr.js";import"./vendor-b0vXyz-r.js";const U=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],B=m("briefcase",U);const F=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],O=m("message-square",F);const W=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],X=m("pen-line",W);const G=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],J=m("save",G),Q=[{value:"new",label:"Ny",color:"bg-slate-500"},{value:"contacted",label:"Kontaktad",color:"bg-sky-500"},{value:"interested",label:"Intresserad",color:"bg-amber-500"},{value:"not_interested",label:"Ej intresserad",color:"bg-red-500"},{value:"converted",label:"Konverterad",color:"bg-brand-500"}],Y=[{value:"high",label:"Hög"},{value:"medium",label:"Medium"},{value:"low",label:"Låg"}],le=r.memo(function({contact:a,onClose:n,onDelete:p}){const h=_(s=>s.updateContact),i=L(),y=A(!0),[l,u]=r.useState(!1),[b,j]=r.useState(!1),[t,o]=r.useState({status:a.status,priority:a.priority,notes:a.notes,contact:a.contact,role:a.role});r.useEffect(()=>{const s=x=>{x.key==="Escape"&&n()};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[n]);const k=r.useCallback(async()=>{if(a.id){j(!0);try{await v.updateContact(a.id,{status:t.status,priority:t.priority,notes:t.notes,contact:t.contact,role:t.role}),h(a.id,t),u(!1),c.success("Kontakt uppdaterad")}catch(s){c.error("Kunde inte spara ändringar"),console.error(s)}finally{j(!1)}}},[a.id,t,h]),w=r.useCallback(async()=>{if(!(!a.id||!p)&&confirm("Är du säker på att du vill radera denna kontakt?"))try{await v.deleteContact(a.id),p(a.id),n(),c.success("Kontakt raderad")}catch(s){c.error("Kunde inte radera kontakt"),console.error(s)}},[a.id,p,n]),C=r.useCallback(async s=>{await K(s)&&c.success("Telefonnummer kopierat")},[]);r.useCallback(s=>{window.location.href=`tel:${s.replace(/\D/g,"")}`},[]);const M=a.name.split(" ").map(s=>s[0]).slice(0,2).join("").toUpperCase(),S=i?"div":g.div,P=i?{}:{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2}};return e.jsxs(E,{children:[e.jsx(g.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:d("fixed inset-0 z-50",i?"mobile-modal-overlay":"bg-black/60 backdrop-blur-sm"),onClick:n,"aria-hidden":"true"}),e.jsxs(S,{...P,ref:y,className:d(i?"mobile-modal-sheet":"fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-50 w-full max-w-2xl max-h-[90vh] overflow-hidden rounded-2xl glass-card"),role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",onClick:s=>s.stopPropagation(),children:[i&&e.jsx("div",{className:"mobile-modal-handle",children:e.jsx("div",{className:"mobile-modal-handle-bar"})}),e.jsxs("div",{className:d("flex items-center gap-4 p-6 border-b border-slate-800/50",i&&"p-4"),children:[e.jsx("div",{className:"w-16 h-16 flex-shrink-0 flex items-center justify-center rounded-2xl bg-gradient-to-br from-brand-500 to-brand-700 text-white font-bold text-xl shadow-lg shadow-brand-500/30",children:M}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{id:"modal-title",className:"text-xl font-bold text-slate-100 truncate",children:a.name}),e.jsx("p",{className:"text-sm text-slate-400",children:a.org||"Inget orgnr"})]}),e.jsx("button",{onClick:n,className:"btn-icon","aria-label":"Stäng",children:e.jsx(D,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:d("overflow-y-auto p-6 space-y-6",i&&"mobile-modal-body"),children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>u(!l),className:d("btn-secondary flex items-center gap-2",l&&"bg-brand-500/20 border-brand-500/50 text-brand-400"),children:[e.jsx(X,{className:"w-4 h-4"}),l?"Avbryt":"Redigera"]}),l&&e.jsxs("button",{onClick:k,disabled:b,className:"btn-primary flex items-center gap-2",children:[e.jsx(J,{className:"w-4 h-4"}),b?"Sparar...":"Spara"]}),e.jsx("button",{onClick:w,className:"btn-ghost text-red-400 hover:text-red-300 hover:bg-red-500/10",children:e.jsx(I,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-2",children:"Status"}),l?e.jsx("select",{value:t.status,onChange:s=>o({...t,status:s.target.value}),className:"select-field",children:Q.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:d("status-dot",`status-${a.status.replace("_","-")}`)}),e.jsx("span",{className:"text-slate-200",children:T(a.status)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-2",children:"Prioritet"}),l?e.jsx("select",{value:t.priority,onChange:s=>o({...t,priority:s.target.value}),className:"select-field",children:Y.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))}):e.jsx("span",{className:"text-slate-200",children:z(a.priority)})]})]}),e.jsxs("div",{className:"grid gap-4",children:[(a.address||a.city)&&e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-xl bg-slate-800/30",children:[e.jsx($,{className:"w-5 h-5 text-slate-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Adress"}),e.jsxs("p",{className:"text-slate-200",children:[a.address,a.address&&a.city&&", ",a.city]})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-xl bg-slate-800/30",children:[e.jsx(R,{className:"w-5 h-5 text-slate-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Kontaktperson"}),l?e.jsx("input",{type:"text",value:t.contact,onChange:s=>o({...t,contact:s.target.value}),className:"input-field mt-1",placeholder:"Namn på kontaktperson"}):e.jsx("p",{className:"text-slate-200",children:a.contact||"—"})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-xl bg-slate-800/30",children:[e.jsx(B,{className:"w-5 h-5 text-slate-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Roll"}),l?e.jsx("input",{type:"text",value:t.role,onChange:s=>o({...t,role:s.target.value}),className:"input-field mt-1",placeholder:"VD, Säljchef, etc."}):e.jsx("p",{className:"text-slate-200",children:a.role||"—"})]})]}),a.phones&&e.jsxs("div",{className:"flex items-start gap-3 p-3 rounded-xl bg-slate-800/30",children:[e.jsx(f,{className:"w-5 h-5 text-slate-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm text-slate-400 mb-2",children:["Telefonnummer (",V(a.phones),")"]}),e.jsx("div",{className:"space-y-2",children:a.phones.split(`
`).filter(Boolean).map((s,x)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-slate-200 font-mono text-sm",children:s}),e.jsx("button",{onClick:()=>C(s),className:"p-1 rounded hover:bg-slate-700/50 text-slate-400 hover:text-slate-200","aria-label":"Kopiera",children:e.jsx(H,{className:"w-3.5 h-3.5"})}),e.jsx("a",{href:`tel:${s.replace(/\D/g,"")}`,className:"p-1 rounded hover:bg-brand-500/20 text-brand-400","aria-label":"Ring",children:e.jsx(f,{className:"w-3.5 h-3.5"})})]},x))})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-slate-400 mb-2",children:[e.jsx(O,{className:"w-4 h-4"}),"Anteckningar"]}),l?e.jsx("textarea",{value:t.notes,onChange:s=>o({...t,notes:s.target.value}),className:"input-field min-h-[120px] resize-y",placeholder:"Lägg till anteckningar om samtalet..."}):e.jsx("div",{className:"p-4 rounded-xl bg-slate-800/30 min-h-[80px]",children:a.notes?e.jsx("p",{className:"text-slate-200 whitespace-pre-wrap",children:a.notes}):e.jsx("p",{className:"text-slate-500 italic",children:"Inga anteckningar"})})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500 pt-4 border-t border-slate-800/50",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(q,{className:"w-3.5 h-3.5"}),"Skapad: ",N(a.createdAt)]}),e.jsxs("span",{children:["Uppdaterad: ",N(a.updatedAt)]})]})]})]})]})});export{le as default};
